[English](README.md)

# TextureChannelPacker

**TextureChannelPacker** は、個別のグレースケールテクスチャを1枚の出力テクスチャの R (赤)、G (緑)、B (青)、A (アルファ) チャンネルに効率的にパッキングするための Unreal Engine 5.7 用プラグインです。ORM（オクルージョン、ラフネス、メタリック）マップや、その他のチャンネルパッキングテクスチャを作成する際に必須のツールです。

## 機能一覧

- **4チャンネルパッキング (RGBA)**: 最大4枚の入力テクスチャを受け取り、それぞれの赤 (Red) チャンネルを出力テクスチャの R、G、B、A チャンネルに割り当てます。
- **スマート命名機能**: 入力テクスチャ名に基づいて、最適な出力ファイル名を自動的に提案します。共通の接頭辞を認識し（例: `T_Rock_AO` + `T_Rock_R` → `T_Rock_ORM`）、入力の手間を省きます。
- **自動リサイズ**: 指定されたターゲット解像度に合わせて、高品質なバイリニア補間で入力テクスチャを自動的にリサイズします。
- **拡張フォーマットサポート**: **8-bit**、**16-bit グレースケール** (ハイトマップ)、**32-bit Float** (SDF/LUT) のソースフォーマットを完全にサポートしています。
- **UIローカライズ**: エディタの言語設定に合わせて、インターフェースが自動的に **英語** と **日本語** に切り替わります。
- **UXの改善**:
  - **ドラッグ＆ドロップ**: コンテンツブラウザから入力スロットへ直接テクスチャをドラッグできます。
  - **パスピッカー**: フォルダアイコンボタンを使って、保存先ディレクトリを簡単に選択できます。
  - **トースト通知**: 成功やエラーの結果を、分かりやすく邪魔にならない通知でフィードバックします。

## 簡単な解説: なぜこのツールを使うの？

最適化に詳しくない方のために、なぜチャンネルパッキングが重要なのか説明します。

- **サンプラー数の節約**: マテリアルが同時に読み込めるテクスチャの数には制限（通常は16枚）があります。3枚のテクスチャ（AO、ラフネス、メタリック）を1枚にまとめることで、サンプラーのスロットを節約し、「Texture Sampler out of bounds」エラーを防ぎます。
- **メモリ効率**: 複数のファイルを別々に読み込むよりも、1つにまとめることでメモリのオーバーヘッドを削減できます。
- **ファイル管理**: ファイル数が大幅に減るため、コンテンツブラウザが整理され、管理しやすくなります。

## インストール方法

1. **クローンまたはダウンロード**:
   このリポジトリをダウンロードし、`TextureChannelPacker` フォルダをプロジェクトの `Plugins` ディレクトリに配置してください。
   - `Plugins` フォルダがない場合は、プロジェクトのルートディレクトリに作成してください。

   構成:
   ```
   MyProject/
   ├── Plugins/
   │   └── TextureChannelPacker/
   ```

2. **プロジェクトファイルの生成**:
   `.uproject` ファイルを右クリックし、**Generate Visual Studio project files** を選択します。

3. **ビルド**:
   `.sln` ファイルを開き、プロジェクトをビルドしてプラグインをコンパイルします。

4. **有効化**:
   Unreal Engine を起動し、**Edit (編集) > Plugins (プラグイン)** から **TextureChannelPacker** を検索して有効にしてください。

## 使用ガイド

### ステップ 1: ツールの起動
メインメニューバーから **Tools (ツール) > Texture Packing** を選択します。ウィンドウはエディタ内の任意の場所にドッキング可能です。

### ステップ 2: 入力の割り当て
- コンテンツブラウザから、Red、Green、Blue、Alpha の各スロットにテクスチャを **ドラッグ＆ドロップ** します。
- **Red/Green/Blue**: 通常はアンビエントオクルージョン、ラフネス、メタリックに使用します。
- **Alpha**: 任意です。空のままだとデフォルトで白（不透明）になります。

### ステップ 3: 出力設定
- **スマート命名機能**: **File Name (ファイル名)** は入力に基づいて自動生成されます（例: `_ORM` サフィックスの付与）が、手動で編集することも可能です。
- **Output Path (出力パス)**: **パスピッカー**（フォルダアイコン）を使用して保存先フォルダを選択します。
- **Resolution (解像度)**: 出力サイズを設定します（有効範囲: 1 - 8192）。
- **Compression Settings (圧縮設定)**: ドロップダウンから適切な圧縮設定を選択します（下の表を参照）。

### ステップ 4: 生成
**Generate Texture** ボタンをクリックします。
- **トースト通知** が表示され、成功またはエラーをお知らせします。
- コンテンツブラウザに新しいアセットが即座に作成されます。

## 技術的詳細

### 対応フォーマット
- **8-bit**: `BGRA8`, `G8` (標準的なテクスチャ)。
- **16-bit**: `G16` (高精度なハイトマップ)。
- **Float**: `R16F`, `R32F`, `RGBA32F` (SDFやLUT)。

### 制限事項
- **クランプ（切り捨て）**: 浮動小数点テクスチャ（SDFやハイトマップ等）の値は、パッキング時に `0.0 - 1.0` の範囲に **クランプ** されます。範囲外の値はクリップされます。

## 圧縮設定

| 設定名 | 最適な用途 | 説明 |
| :--- | :--- | :--- |
| **Masks (推奨)** | **ORMマップ**、パック済みマスク | sRGBを無効化し、チャンネル間の干渉を防ぎます。PBRワークフローに最適です。 |
| **Grayscale** | **ハイトマップ**、単一マスク | リニア値を保持します。1チャンネルのデータに適しています。 |
| **Default** | カラーテクスチャ | 標準的な圧縮です。通常はアルベド（カラー）用であり、チャンネルパッキングには推奨されません。 |

## ライセンス

このプロジェクトは MIT ライセンスの下で公開されています。
